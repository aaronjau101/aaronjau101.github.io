<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Lunar Lander</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
    body, h1,h2,h3,h4,h5,h6 {font-family: "Montserrat", sans-serif}
    .w3-row-padding img {margin-bottom: 12px}
    /* Set the width of the sidebar to 120px */
    .w3-sidebar {width: 120px;background: #222;}
    /* Add a left margin to the "page content" that matches the width of the sidebar (120px) */
    #main {margin-left: 120px}
    /* Remove margins from "page content" on small screens */
    @media only screen and (max-width: 600px) {#main {margin-left: 0}}
    </style>
    <script src="https://cdn.jsdelivr.net/processing.js/1.4.8/processing.min.js"></script> 
  </head>
  <body class="w3-black">
      
    <!-- Icon Bar (Sidebar - hidden on small screens) -->
    <nav class="w3-sidebar w3-bar-block w3-small w3-hide-small w3-center">
      <a href=".../index.html" class="w3-bar-item w3-button w3-padding-large w3-hover-black">
        <i class="fa fa-home w3-xxlarge"></i>
        <p>HOME</p>
      </a>
    </nav>

    <!-- Navbar on small screens (Hidden on medium and large screens) -->
    <div class="w3-top w3-hide-large w3-hide-medium" id="myNavbar">
      <div class="w3-bar w3-black w3-opacity w3-hover-opacity-off w3-center w3-small">
        <a href="../index.html" class="w3-bar-item w3-button" style="width:25% !important">HOME</a>
      </div>
    </div>
    
    <div class="w3-container w3-center" style="padding-top: 25px">
    <h1>Lunar Lander</h1>
    </div>
      <hr>
    <div class="w3-center">
    <canvas id="mycanvas" style="padding-top: 7px"></canvas>
        
    <script>

    var sketchProc = function(processingInstance) {
        with (processingInstance) {
            size(500,500);
            var start = false;

            var gravity = 0.005;

            var rocketForce = -0.0003;
            var rocketAcceleration = 0;
            var maxRocketAcceleration = -0.02;

            var thrusterForce = 0.0003;
            var thrusterAcceleration = 0;
            var maxThrusterAcceleration = 0.02;

            var fuel = 100;

            var timeNow = 0;
            var frame = 0;

            var rocketOn = false;
            var leftThrusterOn = false;
            var rightThrusterOn = false;

            var speedresult = "";
            var landresult = "";

            var landPad = {
              x: random(0, 350),
              y: 450,
              size: 150
            };

            var spaceship = {
              posX: 200,
              posY: 50,
              size: 100,
              speedX: 0,
              speedY: 0
            };

            var setup = function() {
              frameRate(30);
            };

            var draw = function() {
              if(start){
                if(spaceship.posY >= 350){
                  spaceship.posY = 350;
                  if(checkSpeed()){
                    speedresult = "Safe";
                  }else{
                    speedresult = "Unsafe";
                  }
                  if(checkLanding())
                  {
                    landresult = "Hit";
                  }else{
                    landresult = "Miss";
                  }
                }else{
                  frame += 1;
                  timeNow = frame/30;

                  if(rocketOn || leftThrusterOn || rightThrusterOn)
                  {
                    if(fuel > 0){
                      fuel -= 0.5;
                    }else{
                      fuel = 0;
                      rocketAcceleration = 0;
                      thrusterAcceleration = 0;
                    }
                  }

                  if(rocketOn && rocketAcceleration > maxRocketAcceleration)
                  {
                    rocketAcceleration += rocketForce; 
                  }
                  if(rightThrusterOn && thrusterAcceleration > -maxThrusterAcceleration)
                  {
                    thrusterAcceleration -= thrusterForce;
                  }
                  if(leftThrusterOn && thrusterAcceleration < maxThrusterAcceleration)
                  {
                    thrusterAcceleration += thrusterForce;
                  }

                  spaceship.posX += spaceship.speedX;
                  spaceship.posY += spaceship.speedY;

                  spaceship.speedY += timeNow * (gravity + rocketAcceleration);
                  spaceship.speedX += timeNow * (thrusterAcceleration);
                }

                drawText();
                drawSpaceship();
                drawGround();
              }else{
                background(255, 255, 255);
                fill(0);
                textAlign(CENTER);
                textSize(48);
                text("LUNAR LANDER", 250, 100);
                text("TO LAND SAFELY", 250, 250);
                text("USE ARROW KEYS", 250, 300);
                text("CLICK MOUSE", 250, 400);
                text("TO START PLAYING", 250, 450);
              }
            };

            //--------Draw Functions-----------\\

            var drawGround = function() {
              fill(255/2);
              rect(0, 450, 500, 50);
              fill(0, 0, 255);
              rect(landPad.x, landPad.y, landPad.size, 50);
            };

            var drawText = function() {
              background(0, 0, 0);
              textAlign(LEFT);
              textSize(12);
              fill(0, 255, 0);
              rect(0, 0, 150, 150);
              fill(0);
              text("X velocity: " + spaceship.speedX.toFixed(2), 25, 25);
              text("Y velocity: " + spaceship.speedY.toFixed(2), 25, 50);
              text("Fuel: " + fuel.toFixed(2), 25, 75);

              if(rocketOn)
              {
                text("Rocket: On", 25, 100);
              }else{
                text("Rocket: Off", 25, 100);
              }

              if(leftThrusterOn){
                text("Thruster: Left", 25, 125);
              } else if(rightThrusterOn){
                text("Thruster: Right", 25, 125);
              } else {
                text("Thruster: None", 25, 125);
              }

              textAlign(CENTER);
              if(speedresult !== "")
              {
                fill(255, 0, 0);
                rect(200, 200, 100, 30);
                fill(255, 255, 255);
                text("Speed: " + speedresult, 250, 220);
              }
              if(landresult !== "")
              {
                fill(255, 0, 0);
                rect(200, 250, 100, 30);
                fill(255, 255, 255);
                text("Landing: " + landresult, 250, 270);
              }
            };

            var drawSpaceship = function() {
              fill(255);
              rect(spaceship.posX, spaceship.posY, spaceship.size, spaceship.size);
              if(rocketOn)
              {
                fill(255, 0, 0);
                rect(spaceship.posX + (spaceship.size/2) - 5, spaceship.posY + spaceship.size, 10, 30);
              }
              if(leftThrusterOn)
              {
                fill(255, 0, 0);
                rect(spaceship.posX - 30, spaceship.posY + spaceship.size - 10, 30, 10);
              }
              if(rightThrusterOn)
              {
                fill(255, 0, 0);
                rect(spaceship.posX + spaceship.size, spaceship.posY + spaceship.size - 10, 30, 10);
              }
            };

            //--------Other Functions-----------\\

            var checkSpeed = function() {
              if(spaceship.speedY < 1.0 && spaceship.speedX < 0.5 && spaceship.speedX > -0.5){
                return true;
              }else{
                return false;
              }
            };

            var checkLanding = function() {
              if(spaceship.posX > landPad.x && (spaceship.posX + spaceship.size) < (landPad.x + landPad.size)){
                return true;
              }else{
                return false;
              }
            };

            var resetGame = function() {
              fuel = 100;
              rocketAcceleration = 0;
              thrusterAcceleration = 0;
              timeNow = 0;
              frame = 0;
              rocketOn = false;
              leftThrusterOn = false;
              rightThrusterOn = false;

              speedresult = "";
              landresult = "";
              spaceship = {
                posX: 200,
                posY: 50,
                size: 100,
                speedX: 0,
                speedY: 0
              };
              landPad = {
                x: random(0, 350),
                y: 450,
                size: 150
              };
            };

            //--------Event Functions-----------\\

            var keyPressed = function() {
              if(keyCode === DOWN){
                if(fuel > 0 && spaceship.posY < 350){
                  rocketOn = true;
                }else{
                  rocketOn = false;
                  rocketAcceleration = 0;
                }
              }  
              if(keyCode === RIGHT)
              {
                if(fuel > 0 && spaceship.posY < 350 && leftThrusterOn === false){
                  rightThrusterOn = true;
                }else{
                  rightThrusterOn = false;
                  thrusterAcceleration = 0;
                }
              }
              if(keyCode === LEFT)
              {
                if(fuel > 0 && spaceship.posY < 350 && rightThrusterOn === false){
                  leftThrusterOn = true;
                }else{
                  leftThrusterOn = false;
                  thrusterAcceleration = 0;
                }
              }
            };

            var keyReleased = function() {
              if(keyCode === DOWN){
                rocketOn = false;
                rocketAcceleration = 0;
              }
              if(keyCode === RIGHT)
              {
                rightThrusterOn = false;
                thrusterAcceleration = 0;
              }
              if(keyCode === LEFT)
              {
                leftThrusterOn = false;
                thrusterAcceleration = 0;
              }
            };

            var mouseClicked = function() {
              if(start){
                resetGame();
                start = false;
              }else{
                start = true;
              }

            }
        }
    }

    var canvas = document.getElementById("mycanvas"); 
    var processingInstance = new Processing(canvas, sketchProc); 

    </script>
    </div>  
    </body>
    
</html>